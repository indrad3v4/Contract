{% extends "base.html" %}

{% block title %}Smart Contracts - BIM AI Management Dashboard{% endblock %}
{% block page_title %}Smart Contracts{% endblock %}

{% block content %}
<div class="row">
    <div class="col-12">
        <div class="card">
            <div class="card-header">
                <h5 class="card-title">
                    <i data-feather="file-text" class="icon-inline"></i>
                    Property Smart Contracts
                </h5>
                <div class="card-actions">
                    <button class="btn btn-sm btn-outline-info">
                        <i data-feather="plus" class="icon-inline-sm"></i>
                        New Contract
                    </button>
                </div>
            </div>
            <div class="card-body">
                <div class="table-responsive">
                    <table class="table table-hover">
                        <thead>
                            <tr>
                                <th>Contract ID</th>
                                <th>Property</th>
                                <th>Token Symbol</th>
                                <th>Value (USD)</th>
                                <th>Status</th>
                                <th>Created</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>
                                    <span class="d-block">CO-2025-001</span>
                                    <small class="text-muted">0x71C...9E3f</small>
                                </td>
                                <td>Cosmic Tower Project</td>
                                <td>CSMC</td>
                                <td>$15,811,040</td>
                                <td><span class="contract-status status-active">Active</span></td>
                                <td>Apr 3, 2025</td>
                                <td>
                                    <button class="btn btn-sm btn-outline-info">
                                        <i data-feather="eye" class="icon-inline-sm"></i>
                                    </button>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <span class="d-block">CO-2025-002</span>
                                    <small class="text-muted">0x31F...7A2c</small>
                                </td>
                                <td>Nexus Apartments</td>
                                <td>NXAP</td>
                                <td>$8,250,000</td>
                                <td><span class="contract-status status-active">Active</span></td>
                                <td>Mar 21, 2025</td>
                                <td>
                                    <button class="btn btn-sm btn-outline-info">
                                        <i data-feather="eye" class="icon-inline-sm"></i>
                                    </button>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <span class="d-block">CO-2025-003</span>
                                    <small class="text-muted">0x94B...2D5a</small>
                                </td>
                                <td>Horizon Office Complex</td>
                                <td>HZOC</td>
                                <td>$12,500,000</td>
                                <td><span class="contract-status status-pending">Pending</span></td>
                                <td>Mar 15, 2025</td>
                                <td>
                                    <button class="btn btn-sm btn-outline-info">
                                        <i data-feather="eye" class="icon-inline-sm"></i>
                                    </button>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <span class="d-block">CO-2024-015</span>
                                    <small class="text-muted">0x67D...3F1b</small>
                                </td>
                                <td>Summit Residential Tower</td>
                                <td>SMRT</td>
                                <td>$9,750,000</td>
                                <td><span class="contract-status status-completed">Completed</span></td>
                                <td>Dec 10, 2024</td>
                                <td>
                                    <button class="btn btn-sm btn-outline-info">
                                        <i data-feather="eye" class="icon-inline-sm"></i>
                                    </button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="row mt-4">
    <div class="col-12">
        <!-- Contract Details Panel -->
        <div class="contract-details">
            <div class="contract-header">
                <div>
                    <h5 class="contract-title">Cosmic Tower Project</h5>
                    <div class="contract-id">Contract ID: CO-2025-001 (0x71C...9E3f)</div>
                </div>
                <div>
                    <span class="contract-status status-active">Active</span>
                </div>
            </div>
            
            <div class="contract-meta">
                <div class="contract-meta-item">
                    <div class="meta-label">Token Symbol</div>
                    <div class="meta-value">CSMC</div>
                </div>
                <div class="contract-meta-item">
                    <div class="meta-label">Total Value</div>
                    <div class="meta-value">$15,811,040</div>
                </div>
                <div class="contract-meta-item">
                    <div class="meta-label">Token Supply</div>
                    <div class="meta-value">1,000,000 CSMC</div>
                </div>
                <div class="contract-meta-item">
                    <div class="meta-label">Current Token Price</div>
                    <div class="meta-value">$15.81</div>
                </div>
                <div class="contract-meta-item">
                    <div class="meta-label">Creation Date</div>
                    <div class="meta-value">April 3, 2025</div>
                </div>
                <div class="contract-meta-item">
                    <div class="meta-label">Blockchain</div>
                    <div class="meta-value">Odiseo Testnet</div>
                </div>
            </div>
            
            <div class="contract-content">
                <div class="row">
                    <div class="col-md-7">
                        <h6 class="mb-3">Contract Description</h6>
                        <p>This smart contract represents the tokenized ownership of the Cosmic Tower Project, a 17-story commercial high-rise located in Future City. The property has been divided into 1,000,000 tokens, each representing a fractional ownership stake. Token holders are entitled to proportional distribution of rental income and appreciation in property value.</p>
                        
                        <h6 class="mt-4 mb-3">Token Distribution</h6>
                        <div class="chart-container" style="height: 200px;">
                            <canvas id="distribution-chart"></canvas>
                        </div>
                    </div>
                    
                    <div class="col-md-5">
                        <h6 class="mb-3">Recent Transactions</h6>
                        <div class="transaction-list">
                            <div class="transaction-item">
                                <div class="transaction-icon success">
                                    <i data-feather="check-circle"></i>
                                </div>
                                <div class="transaction-details">
                                    <div class="transaction-title">Token Transfer</div>
                                    <div class="transaction-meta">
                                        <span class="transaction-time">2 hours ago</span>
                                    </div>
                                </div>
                                <div class="transaction-value success">+1250 CSMC</div>
                            </div>
                            <div class="transaction-item">
                                <div class="transaction-icon info">
                                    <i data-feather="file-text"></i>
                                </div>
                                <div class="transaction-details">
                                    <div class="transaction-title">Contract Update</div>
                                    <div class="transaction-meta">
                                        <span class="transaction-time">2 days ago</span>
                                    </div>
                                </div>
                                <div class="transaction-value">0 CSMC</div>
                            </div>
                            <div class="transaction-item">
                                <div class="transaction-icon warning">
                                    <i data-feather="refresh-cw"></i>
                                </div>
                                <div class="transaction-details">
                                    <div class="transaction-title">Dividend Distribution</div>
                                    <div class="transaction-meta">
                                        <span class="transaction-time">1 week ago</span>
                                    </div>
                                </div>
                                <div class="transaction-value warning">-350 CSMC</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="signature-section">
                    <h6 class="mb-3">Contract Signatures</h6>
                    <div class="signature-list">
                        <div class="signature-item">
                            <div class="signature-name">John Doe</div>
                            <div class="signature-wallet">0x71C...9E3f</div>
                            <div class="signature-timestamp">Signed on Apr 3, 2025 - 14:32:45 UTC</div>
                        </div>
                        <div class="signature-item">
                            <div class="signature-name">Jane Smith</div>
                            <div class="signature-wallet">0x94B...2D5a</div>
                            <div class="signature-timestamp">Signed on Apr 3, 2025 - 15:05:12 UTC</div>
                        </div>
                        <div class="signature-item">
                            <div class="signature-name">Future City Properties LLC</div>
                            <div class="signature-wallet">0x31F...7A2c</div>
                            <div class="signature-timestamp">Signed on Apr 3, 2025 - 16:17:33 UTC</div>
                        </div>
                        <div class="signature-item">
                            <div class="signature-name">Global Real Estate Ventures</div>
                            <div class="signature-wallet">0x67D...3F1b</div>
                            <div class="signature-timestamp">Signed on Apr 3, 2025 - 18:45:09 UTC</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<!-- Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Initialize distribution chart
        const ctx = document.getElementById('distribution-chart').getContext('2d');
        const distributionChart = new Chart(ctx, {
            type: 'pie',
            data: {
                labels: ['Institutional Investors', 'Private Investors', 'Developer Equity', 'Reserved Pool'],
                datasets: [{
                    data: [45, 25, 20, 10],
                    backgroundColor: [
                        'rgba(224, 13, 121, 0.7)',  // info
                        'rgba(184, 5, 150, 0.7)',   // secondary
                        'rgba(0, 153, 7, 0.7)',     // success
                        'rgba(243, 192, 0, 0.7)'    // warning
                    ],
                    borderColor: 'rgba(255, 255, 255, 0.1)',
                    borderWidth: 1
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        position: 'right',
                        labels: {
                            color: 'rgba(255, 255, 255, 0.7)'
                        }
                    }
                }
            }
        });
        
        // Update feather icons
        feather.replace();
    });
</script>
{% endblock %}
